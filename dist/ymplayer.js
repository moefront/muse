!function(a,b){function d(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))?!0:!1}function e(a,b){b&&!d(a,b)&&(a.className?a.className+=" "+b:a.className=b)}function f(a,b){b&&(a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)","g")," ").replace(/\s+/g," ").replace(/(^\s*)|(\s*$)/g,""),a.className||a.removeAttribute("class"))}function g(a,b){d(a,b)?f(a,b):e(a,b)}function h(a,b){if(isNaN(a))throw"Invalid Number";if(isNaN(b))throw"Invalid Length";var c=Number(a)<0?1:0,d=String(Math.abs(a)),e=Number(b)-d.length-c;if(e>0)for(;e;)d="0"+d,e--;return(c?"-":"")+d}function i(a){var b=a.getBoundingClientRect(),c=document.documentElement.clientTop,d=document.documentElement.clientLeft;return{top:b.top-c,bottom:b.bottom-c,left:b.left-d,right:b.right-d}}function j(a,b,c){return b>=a.left&&b<=a.right&&c>=a.top&&c<=a.bottom?!0:!1}var c={InitPlayer:function(d){var l,m,n,o,p,g=d.getElementsByTagName("song");if(0===g.length)return d.parentNode.removeChild(d),!1;for(a.addEventListener("resize",function(){var g,a=[{maxWidth:686,className:"max-width-686"},{maxWidth:644,className:"max-width-644"},{maxWidth:560,className:"max-width-560"},{maxWidth:400,className:"max-width-400"}],b=d.offsetWidth;for(g=0;g<a.length;g++)f(d,a[g].className),b<=a[g].maxWidth&&e(d,a[g].className);c.SyncLRC(d)}),l=document.createElement("div"),l.setAttribute("class","ym-playlist"),m=b,n=0;n<g.length;n++)single=document.createElement("single"),single.setAttribute("idx",n),single.setAttribute("src",g[n].attributes.src.value),single.setAttribute("artist",g[n].attributes.artist.value),single.setAttribute("song",g[n].attributes.song.value),single.setAttribute("cover",g[n].attributes.cover.value),single.addEventListener("click",function(){c.ChangeAudio(d,this)}),single.innerHTML="<span class='list-number'>"+String(n+1)+"</span>"+"<span class='list-song'>"+g[n].getAttribute("song")+"</span>"+"<span class='list-artist'>"+g[n].getAttribute("artist")+"</span>",l.appendChild(single),0===n&&(m=single);o=document.createElement("audio"),o.setAttribute("preload","yes"),o.addEventListener("loadeddata",function(){var a=parseInt(Math.round(this.duration));d.querySelector(".duration-time").innerHTML=h(Math.floor(a/60),2)+":"+h(a%60,2)}),o.addEventListener("play",function(){d.setAttribute("playing","playing")}),o.addEventListener("pause",function(){d.removeAttribute("playing")}),o.addEventListener("error",function(){var b,a=d.querySelector(".single-active");a&&(b=a.nextSibling,b&&c.ChangeAudio(d,b))}),o.addEventListener("ended",function(){d.removeAttribute("playing");var a=d.querySelector(".single-active");"yes"==d.getAttribute("loop")?c.ChangeAudio(d,a):a.nextSibling&&c.ChangeAudio(d,a.nextSibling)}),o.addEventListener("volumechange",function(){d.querySelector(".volume-current").style.width=String(100*this.volume)+"%",0==this.volume?e(d.querySelector(".vol-button"),"muted"):f(d.querySelector(".vol-button"),"muted")}),o.addEventListener("timeupdate",function(){var a=this.currentTime/this.duration,b=parseInt(Math.round(this.currentTime));d.querySelector(".ym-played").style.width=100*a+"%",d.querySelector(".current-time").innerHTML=h(Math.floor(b/60),2)+":"+h(b%60,2),c.SyncLRC(d,this.currentTime)}),progressBarEle=document.createElement("div"),progressBarEle.setAttribute("class","ym-progress"),progressBarEle.innerHTML="<span class='current-time'>00:00</span><div class='ym-pgbar-outer'><div class='ym-pgbar'><div class='ym-buffed'></div><div class='ym-played'><span class='ym-circle'></span></div></div></div><span class=\"duration-time\">00:00</span>",progressBarEle.querySelector(".ym-pgbar-outer").addEventListener("mousedown",function(a){c.Seek(d,a)}),progressBarEle.querySelector(".ym-pgbar-outer").addEventListener("mousedown",function(a){d.setAttribute("drag","progress"),c.Seek(d,a)}),progressBarEle.querySelector(".ym-pgbar-outer").addEventListener("mousemove",function(a){j(i(progressBarEle),a.clientX,a.clientY)?"progress"==d.getAttribute("drag")&&c.Seek(d,a):d.removeAttribute("drag")}),progressBarEle.querySelector(".ym-pgbar-outer").addEventListener("mouseout",function(a){a.target==this&&d.removeAttribute("drag")}),progressBarEle.querySelector(".ym-pgbar-outer").addEventListener("mouseup",function(){d.removeAttribute("drag")}),conEle=document.createElement("div"),e(conEle,"player-container"),coverEle=document.createElement("div"),e(coverEle,"ym-songinfo"),coverEle.innerHTML="<div class='ym-cover-image'></div><div class='ym-song-detail'><p class='ym-song'></p><p class='ym-artist'></p></div>",conEle.appendChild(coverEle),ctEle=document.createElement("div"),e(ctEle,"ym-controller"),ctEle.innerHTML="<span class='play-button ymbtn'><i class='btn-play'>"+k.play+"</i><i class='btn-pause'>"+k.pause+"</i></span>"+"<i class='stop-button ymbtn'>"+k.stop+"</i>"+"<i class='loop-button ymbtn'>"+k.refresh+"</i>"+(g.length>0?"<i class='list-button ymbtn'>"+k.list+"</i>":"")+"<i class='lyric-button ymbtn'>"+k.lyrics+"</i></a>"+"<span class='vol-button ymbtn'><i class='btn-volume'>"+k.volume+"</i><i class='btn-mute'>"+k.mute+"</i></span>"+"<div class='volume-bar'><div class='volume-bar-inner'><div class='volume-current'><span class='ym-circle'></span></div></div></div>",g.length>0&&ctEle.querySelector(".list-button").addEventListener("click",function(){c.List(d)}),ctEle.querySelector(".lyric-button").addEventListener("click",function(){c.LrcBox(d),c.SyncLRC(d)}),ctEle.querySelector(".play-button").addEventListener("click",function(){c.TogglePlay(d)}),ctEle.querySelector(".stop-button").addEventListener("click",function(){c.Stop(d)}),ctEle.querySelector(".loop-button").addEventListener("click",function(){c.ToggleLoop(d)}),ctEle.querySelector(".vol-button").addEventListener("click",function(){var b=d.getElementsByTagName("audio")[0];b.volume=b.volume>0?0:1}),p=ctEle.querySelector(".volume-bar"),p.addEventListener("mousedown",function(a){d.setAttribute("drag","volume"),c.ChangeVol(d,a)}),p.addEventListener("mousemove",function(a){j(i(p),a.clientX,a.clientY)?"volume"==d.getAttribute("drag")&&c.ChangeVol(d,a):d.removeAttribute("drag")}),p.addEventListener("mouseout",function(a){a.target==this&&d.removeAttribute("drag")}),p.addEventListener("mouseup",function(){d.removeAttribute("drag")}),conEle.appendChild(coverEle),conEle.appendChild(ctEle),lrcBox=document.createElement("div"),lrcBox.setAttribute("class","ym-lrcbox"),lrcBox.innerHTML="<div class='lrc-container'></div><div class='no-lrc'><p>这首歌是没有填词的纯音乐（或者没有找到歌词），请欣赏。</p></div><div class='lrc-fixer' disabled='disabled'><span title='将歌词延后0.5s' class='ym-fix-btn ym-fix-slower'>"+k.angleUp+"</span>"+"<span title='将歌词提前0.5s' class='ym-fix-btn ym-fix-faster'>"+k.angleDown+"</span>"+"</div>",lrcBox.addEventListener("click",function(){c.ToggleFixer(d)}),lrcBox.querySelector(".ym-fix-slower").addEventListener("click",function(a){return this.parentNode.getAttribute("disabled")?!0:(a.preventDefault(),a.stopPropagation(),d.setAttribute("current-lrc-timeoffset",Number(d.getAttribute("current-lrc-timeoffset"))-.5),c.SyncLRC(d),!1)}),lrcBox.querySelector(".ym-fix-faster").addEventListener("click",function(a){return this.parentNode.getAttribute("disabled")?!0:(a.preventDefault(),a.stopPropagation(),d.setAttribute("current-lrc-timeoffset",Number(d.getAttribute("current-lrc-timeoffset"))+.5),c.SyncLRC(d),!1)}),d.appendChild(l),d.appendChild(lrcBox),d.appendChild(o),d.appendChild(progressBarEle),d.appendChild(conEle),m&&c.ChangeAudio(d,m,!0)},TogglePlay:function(a){var b=a.getElementsByTagName("audio")[0];0!=b.paused?b.play():b.pause()},Stop:function(a){a.removeAttribute("playing");var b=a.getElementsByTagName("audio")[0];b.pause(),b.currentTime=0,a.removeAttribute("playing"),a.querySelector(".current-time").innerHTML="00:00",a.querySelector(".ym-played").style.width="0%"},ToggleLoop:function(a){a.setAttribute("loop","no"==a.getAttribute("loop")?"yes":"no")},LrcBox:function(a){f(a.querySelector(".ym-playlist"),"ym-show"),g(a.querySelector(".ym-lrcbox"),"ym-show")},Seek:function(a,b){var c=a.getElementsByTagName("audio")[0],d=a.querySelector(".ym-pgbar-outer"),e=i(d);isNaN(c.duration)||(a.querySelector(".ym-pgbar-outer"),c.currentTime=c.duration*(b.clientX-e.left)/d.offsetWidth)},ChangeVol:function(a,b){var c=a.querySelector(".volume-bar"),d=i(c),e=(b.clientX-d.left)/c.offsetWidth;.01>e?e=0:e>.99&&(e=1),a.getElementsByTagName("audio")[0].volume=e},List:function(a){f(a.querySelector(".ym-lrcbox"),"ym-show"),g(a.querySelector(".ym-playlist"),"ym-show")},SyncLRC:function(a,c){var d,g,h,i,j,k,l,m,n,o;if(a.getAttribute("current-lrc")){for(d=b==c?a.getElementsByTagName("audio")[0].currentTime:c,d+=Number(a.getAttribute("current-lrc-timeoffset")),g=a.getElementsByTagName("lyric"),h=b,i=0;i<g.length-1;i++)j=Number(g[i].getAttribute("timeline")),k=Number(g[i+1].getAttribute("timeline")),0>=i&&j>=d?h=-1:i==g.length-2&&d>=k?h=i+1:k>d&&d>=j&&(h=i);for(h===b&&(h=-1),a.setAttribute("current-lrc",h),l=a.querySelectorAll(".ym-active"),i=0;i<l.length;i++)f(l[i],"ym-active");m=a.querySelector(".ym-lrcbox"),n=a.querySelector(".lrc-container"),0>h?n.style.top=0:(e(g[h],"ym-active"),o=g[h].offsetTop-Math.abs(m.offsetHeight-g[h].offsetHeight)/2,0>o&&(o=0),n.style.top=String(-o)+"px")}},ParseLRC:function(a,b){var d,e,f,g,h,i,j,k,l,m,c=a.querySelector(".lrc-container");if(a.removeAttribute("current-lrc"),a.removeAttribute("current-lrc-timeoffset"),c.innerHTML="",a.querySelector(".lrc-fixer").setAttribute("disabled","disabled"),d=a.getElementsByTagName("song")[b].innerHTML,d=d.replace(/\\n/g,"\n").replace(/\\r/g,"\r"),e=new Array,d){for(f=String(d).split("\n"),g=0;g<f.length;g++)if(h=f[g].replace(/(^\s*)|(\s*$)/g,"")){for(i=Array();;){if(j=/^(\[\d+:\d+(.\d+)?\])(.*)/g.exec(h),!j)break;i.push(j[1]),h=j[j.length-1].replace(/(^\s*)|(\s*$)/g,"")}for(k=0;k<i.length;k++)l=/^\[(\d{1,2}):(\d|[0-5]\d)(\.(\d+))?\]$/g.exec(i[k]),l&&e.push({timestamp:60*Number(l[1])+Number(l[2])+(l[4]?Number("0."+l[4]):0),text:h})}if(e.sort(function(a,b){return a.timestamp>b.timestamp?1:-1}),e.length>0){for(g=0;g<e.length;g++)m=document.createElement("lyric"),m.setAttribute("timeline",e[g].timestamp),m.innerHTML=e[g].text?"<p>"+e[g].text+"</p>":"",c.appendChild(m);a.setAttribute("current-lrc",-1),a.setAttribute("current-lrc-timeoffset",0)}}},ChangeAudio:function(a,b,d){var h,i,j,g=Number(b.getAttribute("idx"));for(a.querySelector(".ym-song").innerHTML=b.getAttribute("song"),a.querySelector(".ym-artist").innerHTML=b.getAttribute("artist"),a.querySelector(".ym-cover-image").style.backgroundImage="url("+b.getAttribute("cover")+")",h=a.querySelectorAll("single.single-active"),i=0;i<h.length;i++)f(h[i],"single-active");e(b,"single-active"),a.querySelector(".duration-time").innerHTML="00:00",j=a.getElementsByTagName("audio")[0],j.setAttribute("src",b.getAttribute("src")),c.ParseLRC(a,g),d||(c.Stop(a),j.play())},ToggleFixer:function(a){a.hasAttribute("current-lrc")&&(fixer=a.querySelector(".lrc-fixer"),fixer.getAttribute("disabled")?fixer.removeAttribute("disabled"):fixer.setAttribute("disabled","disabled"))},Init:function(){var d,e,b=document.getElementsByTagName("ymplayer");if(0!=b.length)for(d=0;d<b.length;d++)c.InitPlayer(b[d]);e=document.createEvent("HTMLEvents"),e.initEvent("resize",!0,!1),e.synthetic=!0,a.dispatchEvent(e)}},k={pause:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1664 192v1408q0 26-19 45t-45 19h-512q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h512q26 0 45 19t19 45zm-896 0v1408q0 26-19 45t-45 19h-512q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h512q26 0 45 19t19 45z"/></svg>',play:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1576 927l-1328 738q-23 13-39.5 3t-16.5-36v-1472q0-26 16.5-36t39.5 3l1328 738q23 13 23 31t-23 31z"/></svg>',stop:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1664 192v1408q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h1408q26 0 45 19t19 45z"/></svg>',refresh:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1639 1056q0 5-1 7-64 268-268 434.5t-478 166.5q-146 0-282.5-55t-243.5-157l-129 129q-19 19-45 19t-45-19-19-45v-448q0-26 19-45t45-19h448q26 0 45 19t19 45-19 45l-137 137q71 66 161 102t187 36q134 0 250-65t186-179q11-17 53-117 8-23 30-23h192q13 0 22.5 9.5t9.5 22.5zm25-800v448q0 26-19 45t-45 19h-448q-26 0-45-19t-19-45 19-45l138-138q-148-137-349-137-134 0-250 65t-186 179q-11 17-53 117-8 23-30 23h-199q-13 0-22.5-9.5t-9.5-22.5v-7q65-268 270-434.5t480-166.5q146 0 284 55.5t245 156.5l130-129q19-19 45-19t45 19 19 45z"/></svg>',list:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M256 1312v192q0 13-9.5 22.5t-22.5 9.5h-192q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h192q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-192q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h192q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-192q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h192q13 0 22.5 9.5t9.5 22.5zm1536 768v192q0 13-9.5 22.5t-22.5 9.5h-1344q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1344q13 0 22.5 9.5t9.5 22.5zm-1536-1152v192q0 13-9.5 22.5t-22.5 9.5h-192q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h192q13 0 22.5 9.5t9.5 22.5zm1536 768v192q0 13-9.5 22.5t-22.5 9.5h-1344q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1344q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-1344q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1344q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-1344q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1344q13 0 22.5 9.5t9.5 22.5z"/></svg>',lyrics:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1596 476q14 14 28 36h-472v-472q22 14 36 28zm-476 164h544v1056q0 40-28 68t-68 28h-1344q-40 0-68-28t-28-68v-1600q0-40 28-68t68-28h800v544q0 40 28 68t68 28zm160 736v-64q0-14-9-23t-23-9h-704q-14 0-23 9t-9 23v64q0 14 9 23t23 9h704q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-704q-14 0-23 9t-9 23v64q0 14 9 23t23 9h704q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-704q-14 0-23 9t-9 23v64q0 14 9 23t23 9h704q14 0 23-9t9-23z"/></svg>',volume:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1088 352v1088q0 26-19 45t-45 19-45-19l-333-333h-262q-26 0-45-19t-19-45v-384q0-26 19-45t45-19h262l333-333q19-19 45-19t45 19 19 45zm384 544q0 76-42.5 141.5t-112.5 93.5q-10 5-25 5-26 0-45-18.5t-19-45.5q0-21 12-35.5t29-25 34-23 29-35.5 12-57-12-57-29-35.5-34-23-29-25-12-35.5q0-27 19-45.5t45-18.5q15 0 25 5 70 27 112.5 93t42.5 142z"/></svg>',mute:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1280 352v1088q0 26-19 45t-45 19-45-19l-333-333h-262q-26 0-45-19t-19-45v-384q0-26 19-45t45-19h262l333-333q19-19 45-19t45 19 19 45z"/></svg>',angleUp:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1395 1184q0 13-10 23l-50 50q-10 10-23 10t-23-10l-393-393-393 393q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l466 466q10 10 10 23z"/></svg>',angleDown:'<svg width="1792" height="1792" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1395 736q0 13-10 23l-466 466q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l393 393 393-393q10-10 23-10t23 10l50 50q10 10 10 23z"/></svg>'};a.Ymplayer=c}(window,void 0);
